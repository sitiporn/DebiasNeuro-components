config: ./configs/pcgu_config.yaml
== statistic ==
{'High-overlap': 0.7777777777777778, 'Low-overlap': 0.0}
Counterfactual type: ['High-overlap']
Intervention type : weaken
loading NIE : ../NIE/recent_baseline/seed_3990/avg_embeddings_High-overlap_computed_all_layers_.pickle
++++++++ Component-Neuron_id: 0.05 neurons :+++++++++
Done saving top neurons into pickle !
loading NIE : ../NIE/recent_baseline/seed_409/avg_embeddings_High-overlap_computed_all_layers_.pickle
++++++++ Component-Neuron_id: 0.05 neurons :+++++++++
Done saving top neurons into pickle !
loading NIE : ../NIE/recent_baseline/seed_1548/avg_embeddings_High-overlap_computed_all_layers_.pickle
++++++++ Component-Neuron_id: 0.05 neurons :+++++++++
Done saving top neurons into pickle !
loading NIE : ../NIE/recent_baseline/seed_3099/avg_embeddings_High-overlap_computed_all_layers_.pickle
++++++++ Component-Neuron_id: 0.05 neurons :+++++++++
Done saving top neurons into pickle !
loading NIE : ../NIE/recent_baseline/seed_3785/avg_embeddings_High-overlap_computed_all_layers_.pickle
++++++++ Component-Neuron_id: 0.05 neurons :+++++++++
Done saving top neurons into pickle !
Loading model from ../models/debug_baseline/seed_3990/checkpoint-4000/pytorch_model.bin
saving without condition distribution into : ../pickles/performances/inference_multinli.pickle
loading distributions and labels from : ../pickles/performances/inference_multinli.pickle
compute_acc modes:['Null']
overall acc : 0.8199755899104963
contradiction acc : 0.8657407407407407
entailment acc : 0.7811146404851285
neutral acc : 0.8155960370725471
saving without condition distribution into : ../pickles/performances/inference_heuristics.pickle
hans loading from : ../pickles/performances/inference_heuristics.pickle
saving text answer's bert predictions: ../pickles/performances/hans_text_answers.txt
Heuristic  entailed results:
lexical_overlap: 0.9458
subsequence: 0.9974
constituent: 0.9966
Heuristic  non-entailed results:
lexical_overlap: 0.5274
subsequence: 0.0642
constituent: 0.0758
saving evaluation predictoins into : ../pickles/performances/hans_scores.txt
average score : 0.6011999845504761
has score :0.6011999845504761
Loading model from ../models/debug_baseline/seed_409/checkpoint-3500/pytorch_model.bin
saving without condition distribution into : ../pickles/performances/inference_multinli.pickle
loading distributions and labels from : ../pickles/performances/inference_multinli.pickle
compute_acc modes:['Null']
overall acc : 0.8183482506102523
contradiction acc : 0.8722222222222222
entailment acc : 0.8149003753970546
neutral acc : 0.7663790348354107
saving without condition distribution into : ../pickles/performances/inference_heuristics.pickle
hans loading from : ../pickles/performances/inference_heuristics.pickle
saving text answer's bert predictions: ../pickles/performances/hans_text_answers.txt
Heuristic  entailed results:
lexical_overlap: 0.9214
subsequence: 0.9966
constituent: 0.989
Heuristic  non-entailed results:
lexical_overlap: 0.5348
subsequence: 0.0974
constituent: 0.123
saving evaluation predictoins into : ../pickles/performances/hans_scores.txt
average score : 0.610366702079773
has score :0.610366702079773
Loading model from ../models/debug_baseline/seed_1548/checkpoint-3500/pytorch_model.bin
saving without condition distribution into : ../pickles/performances/inference_multinli.pickle
loading distributions and labels from : ../pickles/performances/inference_multinli.pickle
compute_acc modes:['Null']
overall acc : 0.8289259560618389
contradiction acc : 0.8089506172839506
entailment acc : 0.8437770719029744
neutral acc : 0.8331735378715245
saving without condition distribution into : ../pickles/performances/inference_heuristics.pickle
hans loading from : ../pickles/performances/inference_heuristics.pickle
saving text answer's bert predictions: ../pickles/performances/hans_text_answers.txt
Heuristic  entailed results:
lexical_overlap: 0.9814
subsequence: 1.0
constituent: 0.9992
Heuristic  non-entailed results:
lexical_overlap: 0.327
subsequence: 0.0266
constituent: 0.0304
saving evaluation predictoins into : ../pickles/performances/hans_scores.txt
average score : 0.5607666373252869
has score :0.5607666373252869
Loading model from ../models/debug_baseline/seed_3099/checkpoint-7500/pytorch_model.bin
saving without condition distribution into : ../pickles/performances/inference_multinli.pickle
loading distributions and labels from : ../pickles/performances/inference_multinli.pickle
compute_acc modes:['Null']
overall acc : 0.8266883645240033
contradiction acc : 0.8182098765432099
entailment acc : 0.835980363846376
neutral acc : 0.8251837647810802
saving without condition distribution into : ../pickles/performances/inference_heuristics.pickle
hans loading from : ../pickles/performances/inference_heuristics.pickle
saving text answer's bert predictions: ../pickles/performances/hans_text_answers.txt
Heuristic  entailed results:
lexical_overlap: 0.9832
subsequence: 0.9998
constituent: 0.992
Heuristic  non-entailed results:
lexical_overlap: 0.0288
subsequence: 0.007
constituent: 0.0264
saving evaluation predictoins into : ../pickles/performances/hans_scores.txt
average score : 0.5061999559402466
has score :0.5061999559402466
Loading model from ../models/debug_baseline/seed_3785/checkpoint-3500/pytorch_model.bin
saving without condition distribution into : ../pickles/performances/inference_multinli.pickle
loading distributions and labels from : ../pickles/performances/inference_multinli.pickle
compute_acc modes:['Null']
overall acc : 0.8200772986167616
contradiction acc : 0.8265432098765432
entailment acc : 0.7811146404851285
neutral acc : 0.8565036752956217
saving without condition distribution into : ../pickles/performances/inference_heuristics.pickle
hans loading from : ../pickles/performances/inference_heuristics.pickle
saving text answer's bert predictions: ../pickles/performances/hans_text_answers.txt
Heuristic  entailed results:
lexical_overlap: 0.9766
subsequence: 0.9998
constituent: 0.9974
Heuristic  non-entailed results:
lexical_overlap: 0.3472
subsequence: 0.1592
constituent: 0.3048
saving evaluation predictoins into : ../pickles/performances/hans_scores.txt
average score : 0.6308333277702332
has score :0.6308333277702332
==================== Avearge scores ===================
average overall acc : 0.8228030919446706
averge contradiction acc : 0.8383333333333333
average entailment acc : 0.8113774184233323
average neutral acc : 0.8193672099712369
avarge hans score : 0.58187335729599
